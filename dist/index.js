import a from"crypto";var h=class{constructor(s="sha256",t=64){this.algorithm=s,this.saltLength=t}verify(s,t){let{algorithm:i,salt:r}=this.parse(s);return this.hash(t,i,r)===s}encode(s){let t=a.randomBytes(this.saltLength).toString("base64");return this.hash(s,this.algorithm,t)}hash(s,t,i){let r=a.createHash(t);return r.update(s),r.update(i,"utf8"),`${t}:${i}:${r.digest("base64")}`}parse(s){let t=s.split(":");if(t.length!==3)throw new Error(`Invalid hash string. Expected 3 parts, got ${t.length}`);let i=t[0],r=t[1],n=t[2];return{algorithm:i,salt:r,digest:n}}},o=new h;export{h as Hasher,o as hash};
